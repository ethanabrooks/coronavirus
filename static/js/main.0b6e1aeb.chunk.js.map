{"version":3,"sources":["App.tsx","serviceWorker.js","index.js"],"names":["margin","Chart","rawData","React","useEffect","listener","setWindow","width","window","innerWidth","height","innerHeight","addEventListener","removeEventListener","useState","mousePos","setMousePos","highlightedState","setHighlightedState","selecting","setSelecting","parsedData","useMemo","List","map","e","date","Date","dateChecked","valueOf","isNaN","filter","isPresent","statesToDates","groupBy","state","entries","first","positive","toOrderedMap","sortBy","_","k","last","Set","keys","included","setIncluded","initialExtent","d3","toArray","d","left","right","has","min","x","y","max","zoom","setZoom","includedExtent","extent","daysToStates","second","Math","round","sort","reverse","keySeq","minDay","maxDay","paths","domain","range","line","p","s","isHighlighted","a","push","Fragment","key","fill","stroke","opacity","onMouseEnter","onMouseLeave","oldState","onClick","of","tooltipPath","tooltip","pageToDay","dayToPage","xpos","strokeWidth","style","pointerEvents","fontSize","userSelect","get","dy","valueSeq","stateList","isIncluded","delete","add","onDoubleClick","size","selectionArea","rectExtent","to","from","overflow","xInverse","yInverse","float","onMouseDown","pageX","pageY","onMouseMove","onMouseUp","className","viewBox","type","setState","fetch","then","res","json","error","message","Boolean","location","hostname","match","ReactDOM","render","App","document","getElementById","navigator","serviceWorker","ready","registration","unregister","catch","console"],"mappings":"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","file":"static/js/main.0b6e1aeb.chunk.js","sourcesContent":["import React from \"react\";\nimport * as d3 from \"d3\";\nimport { Collection, List, Set } from \"immutable\";\nimport { isPresent } from \"ts-is-present\";\n\ntype RawEntry = { state: string; positive: number; dateChecked: string };\ntype Entry = { state: string; positive: number; dateChecked: number };\ntype XY = { x: number; y: number };\ntype Extent = { min: XY; max: XY };\n\nconst highlightColor = \"#ff0079\";\nconst defaultColor = \"#00b6c6\";\nconst margin = { right: 100, bottom: 100 };\n\nfunction datediff(first: number, second: number): number {\n  // Take the difference between the dates and divide by milliseconds per day.\n  // Round to nearest whole number to deal with DST.\n  return Math.round((second - first) / (1000 * 60 * 60 * 24));\n}\n\nconst Chart: React.FC<{ rawData: RawEntry[] }> = ({ rawData }) => {\n  React.useEffect(() => {\n    const listener = () =>\n      setWindow({ width: window.innerWidth, height: window.innerHeight });\n    window.addEventListener(\"resize\", listener);\n    return () => window.removeEventListener(\"resize\", listener);\n  }, []);\n\n  const [mousePos, setMousePos] = React.useState<XY | null>(null);\n  const [highlightedState, setHighlightedState] = React.useState<string | null>(\n    null\n  );\n  const [{ width, height }, setWindow] = React.useState<{\n    width: number;\n    height: number;\n  }>({ width: window.innerWidth, height: window.innerHeight });\n\n  const [selecting, setSelecting] = React.useState<null | {\n    from: XY;\n    to: null | XY;\n  }>(null);\n\n  const parsedData = React.useMemo(\n    () =>\n      List(rawData)\n        .map((e) => {\n          const date = new Date(e.dateChecked).valueOf();\n          return isNaN(date) ? null : { ...e, dateChecked: date };\n        })\n        .filter(isPresent),\n    [rawData]\n  );\n\n  const statesToDates = React.useMemo(\n    () =>\n      parsedData\n        .groupBy((e) => e.state)\n        .map((entries) =>\n          entries\n            .groupBy((e) => e.dateChecked)\n            .map((entries: Collection<number, Entry>): Entry => entries.first())\n            .map((e) => e.positive)\n            .toOrderedMap()\n            .sortBy((_, k) => k)\n        )\n        .toOrderedMap()\n        .sortBy((entries) => -(entries.last() as number)),\n    [parsedData]\n  );\n\n  const [included, setIncluded] = React.useState<Set<string>>(\n    Set(statesToDates.keys())\n  );\n\n  const initialExtent = React.useMemo(() => {\n    const [left, right] = d3.extent(\n      parsedData.toArray(),\n      (d) => d.dateChecked\n    ) as number[];\n    const [top, bottom] = d3.extent(\n      parsedData.filter((e) => included.has(e.state)).toArray(),\n      (d) => d.positive\n    ) as number[];\n    return {\n      min: { x: left, y: top },\n      max: { x: right, y: bottom },\n    };\n  }, [parsedData, included]);\n\n  const [zoom, setZoom] = React.useState<Extent | null>(null);\n\n  const includedExtent = React.useMemo(() => {\n    const [left, right] = d3.extent(\n      parsedData.filter((e) => included.has(e.state)).toArray(),\n      (d) => d.dateChecked\n    ) as number[];\n    const [top, bottom] = d3.extent(\n      parsedData.filter((e) => included.has(e.state)).toArray(),\n      (d) => d.positive\n    ) as number[];\n    return {\n      min: { x: left, y: top },\n      max: { x: right, y: bottom },\n    };\n  }, [parsedData, included]);\n\n  const extent = zoom ? zoom : includedExtent;\n\n  const daysToStates = React.useMemo(\n    () =>\n      parsedData\n        .groupBy((e) => {\n          return datediff(initialExtent.min.x, e.dateChecked);\n        })\n        .map((entries) =>\n          entries\n            .groupBy((e) => e.state)\n            .map((entries: Collection<number, Entry>): Entry => entries.first())\n            .map((e) => e.positive)\n            .toOrderedMap()\n            .sort().reverse()\n        )\n        .toOrderedMap()\n        .sortBy((entries) => -(entries.last() as number)),\n    [parsedData, initialExtent]\n  );\n\n  const [minDay, maxDay] = React.useMemo(\n    () => d3.extent(daysToStates.keySeq().toArray(), (d) => d) as number[],\n    [daysToStates]\n  );\n\n  const paths = React.useMemo(() => {\n    const x = d3\n      .scaleLinear()\n      .domain([extent.min.x, extent.max.x])\n      .range([0, width - margin.right]);\n\n    const y = d3\n      .scaleLinear()\n      .domain([extent.min.y, extent.max.y])\n      .range([height - margin.bottom, 0]);\n\n    const line = d3\n      .line()\n      .x(([d, _]) => x(d))\n      .y(([_, p]) => y(p));\n\n    return statesToDates\n      .filter((_, state) => included.has(state))\n      .map((d, s) => {\n        const isHighlighted = s === highlightedState;\n        const a = List(d.entries())\n          .push([includedExtent.max.x, 0])\n          .push([includedExtent.min.x, 0]);\n\n        return (\n          <React.Fragment key={s}>\n            <path\n              fill=\"none\"\n              stroke={isHighlighted ? highlightColor : \"none\"}\n              d={`${line(d.toArray())}`}\n              opacity={isHighlighted ? 0.7 : 0.2}\n            />\n            <path\n              fill={defaultColor}\n              d={`${line(a.toArray())}`}\n              opacity={isHighlighted ? 0.7 : 0.2}\n              onMouseEnter={() => setHighlightedState(s)}\n              onMouseLeave={() =>\n                setHighlightedState((oldState) =>\n                  oldState === s ? null : oldState\n                )\n              }\n              onClick={() => setIncluded(Set.of(s))}\n            />\n          </React.Fragment>\n        );\n      })\n      .toArray();\n  }, [\n    extent,\n    highlightedState,\n    statesToDates,\n    includedExtent,\n    height,\n    width,\n    included,\n  ]);\n\n  let tooltipPath: JSX.Element | null = null;\n  let tooltip: JSX.Element | null = null;\n  if (mousePos != null && mousePos.x < width - margin.right) {\n    const line = d3\n      .line()\n      .x(([a, _]) => a)\n      .y(([_, b]) => b);\n    const pageToDay = d3\n      .scaleLinear()\n      .domain([0, width - margin.right])\n      .range([minDay, maxDay]);\n    const dayToPage = d3\n      .scaleLinear()\n      .domain([minDay, maxDay])\n      .range([0, width - margin.right]);\n    const xpos = Math.round(pageToDay(mousePos.x));\n    tooltipPath = (\n      <path\n        fill=\"none\"\n        stroke={\"black\"}\n        strokeWidth={0.15}\n        d={`${line([\n          [dayToPage(xpos), 0],\n          [dayToPage(xpos), height],\n        ])}`}\n        style={{ pointerEvents: \"none\" }}\n      />\n    );\n    tooltip = (\n      <text style={{ fontSize: 10, userSelect: \"none\" }}>\n        {daysToStates\n          .get(xpos)\n          ?.filter((_, state) => included.has(state))\n          .map((d, state) => {\n            const fill = state === highlightedState ? highlightColor : \"black\";\n            return (\n              <tspan\n                x={\n                  mousePos.x + 80 < width - margin.right\n                    ? mousePos.x + 30\n                    : mousePos.x - 60\n                }\n                dy={12}\n                fill={fill}\n              >\n                {state}: {d}\n              </tspan>\n            );\n          })\n          .valueSeq()\n          .toArray()}\n      </text>\n    );\n  }\n\n  const stateList = React.useMemo(\n    () => (\n      <text style={{ fontSize: 10, userSelect: \"none\" }}>\n        {statesToDates\n          .sortBy((_, k) => k)\n          .map((d, s) => {\n            const isIncluded = included.has(s);\n            const fill = isIncluded ? \"black\" : \"lightgrey\";\n            return (\n              <tspan\n                x={10}\n                dy={12.8}\n                fill={fill}\n                onClick={() => {\n                  setIncluded(\n                    isIncluded ? included.delete(s) : included.add(s)\n                  );\n                }}\n                onDoubleClick={() => {\n                  setIncluded(\n                    included.size === 1 && included.has(s)\n                      ? Set(statesToDates.keys())\n                      : Set.of(s)\n                  );\n                  setZoom(null);\n                }}\n              >\n                {s}\n              </tspan>\n            );\n          })\n          .valueSeq()\n          .toArray()}\n      </text>\n    ),\n    [included, statesToDates]\n  );\n\n  let selectionArea: null | JSX.Element = null;\n  let rectExtent: null | Extent = null;\n  if (selecting && selecting.to) {\n    rectExtent = {\n      min: {\n        x: Math.min(selecting.from.x, selecting.to.x),\n        y: Math.min(selecting.from.y, selecting.to.y),\n      },\n      max: {\n        x: Math.max(selecting.from.x, selecting.to.x),\n        y: Math.max(selecting.from.y, selecting.to.y),\n      },\n    };\n    selectionArea = (\n      <svg style={{ overflow: \"visible\" }}>\n        <rect\n          x={rectExtent.min.x}\n          y={rectExtent.min.y}\n          width={rectExtent.max.x - rectExtent.min.x}\n          height={rectExtent.max.y - rectExtent.min.y}\n          fill=\"black\"\n          opacity={0.3}\n        />\n      </svg>\n    );\n  }\n\n  const xInverse = d3\n    .scaleLinear()\n    .domain([0, width - margin.right])\n    .range([extent.min.x, extent.max.x]);\n\n  const yInverse = d3\n    .scaleLinear()\n    .domain([0, height - margin.bottom])\n    .range([extent.max.y, extent.min.y]);\n\n  return (\n    <div>\n      <div style={{ float: \"right\", width: width, height: 0 }}>\n        {selectionArea}\n      </div>\n      <div\n        style={{ float: \"left\", width: width - margin.right }}\n        onDoubleClick={() => {\n          setIncluded(Set(statesToDates.keys()));\n          setZoom(null);\n          setSelecting(null);\n        }}\n        onClick={() => setSelecting(null)}\n        onMouseLeave={() => setSelecting(null)}\n        onMouseDown={(e) => {\n          setSelecting({\n            from: { x: e.pageX, y: e.pageY },\n            to: null,\n          });\n        }}\n        onMouseMove={(e) => {\n          if (selecting) {\n            setSelecting({\n              ...selecting,\n              to: { x: e.pageX, y: e.pageY },\n            });\n          }\n        }}\n        onMouseUp={(e) => {\n          if (selecting && rectExtent) {\n            const rectSize =\n              (rectExtent.max.x - rectExtent.min.x) *\n              (rectExtent.max.y - rectExtent.min.y);\n            if (rectSize > 50) {\n              setZoom({\n                min: {\n                  x: xInverse(rectExtent.min.x),\n                  y: yInverse(rectExtent.max.y),\n                },\n                max: {\n                  x: xInverse(rectExtent.max.x),\n                  y: yInverse(rectExtent.min.y),\n                },\n              });\n            }\n          } else {\n            setZoom(null);\n            setSelecting(null);\n          }\n        }}\n      >\n        <svg\n          className=\"d3-component\"\n          viewBox={`${[0, 0, width - margin.right, height - margin.bottom]}`}\n          onMouseMove={(e) => setMousePos({ x: e.pageX, y: e.pageY })}\n        >\n          {paths}\n          {tooltipPath}\n          {tooltip}\n        </svg>\n      </div>\n      <div style={{ float: \"left\", width: margin.right }}>\n        <svg style={{ overflow: \"visible\" }}>{stateList}</svg>\n      </div>\n    </div>\n  );\n};\n\nexport default function () {\n  type State =\n    | { type: \"loading\" }\n    | { type: \"error\"; error: any }\n    | { type: \"loaded\"; rawData: RawEntry[] };\n\n  const [state, setState] = React.useState<State>({ type: \"loading\" });\n\n  React.useEffect(() => {\n    fetch(\"https://covidtracking.com/api/states/daily\")\n      .then((res) => res.json())\n      .then(\n        (rawData) => setState({ type: \"loaded\", rawData }),\n        (error) => setState({ type: \"error\", error })\n      );\n  }, []);\n\n  switch (state.type) {\n    case \"loading\":\n      return <div>Loading…</div>;\n    case \"error\":\n      return <div>Error: {state.error.message}</div>;\n    case \"loaded\":\n      return <Chart rawData={state.rawData} />;\n  }\n}\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === \"localhost\" ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === \"[::1]\" ||\n    // 127.0.0.0/8 are considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport function register(config) {\n  if (process.env.NODE_ENV === \"production\" && \"serviceWorker\" in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener(\"load\", () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            \"This web app is being served cache-first by a service \" +\n              \"worker. To learn more, visit https://bit.ly/CRA-PWA\"\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then((registration) => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === \"installed\") {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                \"New content is available and will be used when all \" +\n                  \"tabs for this page are closed. See https://bit.ly/CRA-PWA.\"\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log(\"Content is cached for offline use.\");\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch((error) => {\n      console.error(\"Error during service worker registration:\", error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl, {\n    headers: { \"Service-Worker\": \"script\" },\n  })\n    .then((response) => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get(\"content-type\");\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf(\"javascript\") === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then((registration) => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        \"No internet connection found. App is running in offline mode.\"\n      );\n    });\n}\n\nexport function unregister() {\n  if (\"serviceWorker\" in navigator) {\n    navigator.serviceWorker.ready\n      .then((registration) => {\n        registration.unregister();\n      })\n      .catch((error) => {\n        console.error(error.message);\n      });\n  }\n}\n","import React from \"react\";\nimport ReactDOM from \"react-dom\";\nimport \"./index.css\";\nimport App from \"./App\";\nimport * as serviceWorker from \"./serviceWorker\";\n\nReactDOM.render(<App />, document.getElementById(\"root\"));\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister();\n"],"sourceRoot":""}